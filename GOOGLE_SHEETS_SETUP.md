# Google Sheets 연동 설정 가이드

RSVP 폼 제출 시 Google Sheets에 자동으로 데이터가 추가되도록 설정하는 방법입니다.

## 1. Google Sheets 준비

1. [Google Sheets](https://sheets.google.com)에 접속하여 새 스프레드시트를 만듭니다.
2. 스프레드시트 이름을 원하는 이름으로 변경합니다 (예: "결혼식 RSVP")

## 2. Google Apps Script 설정

1. Google Sheets에서 **확장 프로그램** > **Apps Script**를 클릭합니다.
2. `google-apps-script.js` 파일의 내용을 복사하여 Apps Script 편집기에 붙여넣습니다.
3. 상단의 **저장** 아이콘을 클릭하여 저장합니다.
4. 프로젝트 이름을 설정합니다 (예: "RSVP to Sheets").

## 3. 웹 앱 배포

1. Apps Script 편집기에서 **배포** > **새 배포**를 클릭합니다.
2. **유형 선택** 옆의 톱니바퀴 아이콘을 클릭하고 **웹 앱**을 선택합니다.
3. 다음 설정을 입력합니다:
   - **설명**: "RSVP Form to Google Sheets" (선택사항)
   - **다음 사용자로 실행**: **나**
   - **액세스 권한**: **모든 사용자**
4. **배포** 버튼을 클릭합니다.
5. 권한 승인 창이 나타나면:
   - **권한 확인**을 클릭합니다.
   - Google 계정을 선택합니다.
   - **고급** > **[프로젝트 이름](안전하지 않을 수 있음)로 이동**을 클릭합니다.
   - **허용**을 클릭합니다.
6. 배포가 완료되면 **웹 앱 URL**이 표시됩니다. 이 URL을 복사합니다.

## 4. 환경 변수 설정

1. 프로젝트 루트 디렉토리에 `.env` 파일을 만듭니다 (이미 있다면 수정).
2. 다음 내용을 추가합니다:

```env
REACT_APP_GOOGLE_SHEETS_WEB_APP_URL=https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec
```

`YOUR_SCRIPT_ID` 부분을 위에서 복사한 웹 앱 URL로 교체합니다.

## 5. 앱 재시작

환경 변수를 추가한 후 개발 서버를 재시작합니다:

```bash
npm start
```

## 테스트

1. RSVP 폼을 작성하고 제출합니다.
2. Google Sheets를 새로고침하여 데이터가 추가되었는지 확인합니다.

## 문제 해결

### 데이터가 추가되지 않는 경우

1. **웹 앱 URL 확인**: `.env` 파일의 URL이 올바른지 확인합니다.
2. **권한 확인**: Apps Script에서 웹 앱이 "모든 사용자"로 배포되었는지 확인합니다.
3. **시트 이름 확인**: Apps Script 코드의 `SHEET_NAME` 변수가 실제 시트 이름과 일치하는지 확인합니다.
4. **브라우저 콘솔 확인**: 개발자 도구의 콘솔에서 오류 메시지를 확인합니다.

### CORS 오류가 발생하는 경우

Google Apps Script 웹 앱은 CORS를 지원하므로 일반적으로 문제가 없습니다. 만약 오류가 발생한다면:
- 웹 앱이 올바르게 배포되었는지 확인합니다.
- "모든 사용자" 권한으로 배포되었는지 확인합니다.

## 참고사항

- Google Sheets 저장은 선택적입니다. 실패해도 Supabase 저장은 계속 진행됩니다.
- Google Sheets 저장 실패는 콘솔에 경고로만 표시되며, 사용자에게는 오류가 표시되지 않습니다.
- 환경 변수가 설정되지 않으면 Google Sheets 저장은 건너뜁니다.

